<odoo>
  <data>
      <record id="base.view_partner_form" model="ir.ui.view">
          <field name="name">res.partner.form</field>
          <field name="model">res.partner</field>
          <field name="priority" eval="1"/>
          <field name="arch" type="xml">
              <form string="Partners">
              <div class="alert alert-warning oe_edit_only" role="alert" name="warning_tax" invisible="not same_vat_partner_id">
                A partner with the same <span><span class="o_vat_label">Tax ID</span></span> already exists (<field name="same_vat_partner_id" context="{'show_address': False, 'show_vat': False}"/>), are you sure to create a new one?
              </div>
              <div class="alert alert-warning oe_edit_only" role="alert" name="warning_company" invisible="not same_company_registry_partner_id">
                A partner with the same <span><span class="o_vat_label">Company Registry</span></span> already exists (<field name="same_company_registry_partner_id" context="{'show_address': False, 'show_vat': False}"/>), are you sure to create a new one?
              </div>
              <header>
                    <button string="Initiate Verification"
                        type="object" name="create_verified_user"
                        invisible="state in ['verify_pass', 'active']"/>
                    <button string="Update Phone Code"
                        type="object" name="remove_duplicate_phone_codes" invisible="1"/>
                    <field name="state" widget="statusbar"/>
              </header>
              <sheet>
                  <div class="oe_button_box" name="button_box"/>
                  <widget name="web_ribbon" title="Archived" bg_color="text-bg-danger" invisible="active"/>
                  <field name="avatar_128" invisible="1"/>
                  <field name="image_1920" widget='image' class="oe_avatar" options='{"preview_image": "avatar_128"}'/>
                  <div class="oe_title mb24">
                      <field name="dob" invisible="1"/>
                      <field name="is_company" invisible="1"/>
                      <field name="commercial_partner_id" invisible="1"/>
                      <field name="active" invisible="1"/>
                      <field name="company_id" invisible="1"/>
                      <field name="country_code" invisible="1"/>
                      <field name="company_type" widget="radio" invisible="1" options="{'horizontal': true}"/>
                      <h1 style="display:none;">
                          <field id="company" options="{'line_breaks': False}" widget="text" class="text-break" name="name" default_focus="1" placeholder="e.g. Lumber Inc" invisible="not is_company" required="type == 'contact'"/>
                          <field id="individual" options="{'line_breaks': False}" widget="text" class="text-break" name="name" default_focus="1" placeholder="e.g. Brandom Freeman" invisible="is_company" required="type == 'contact'"/>
                      </h1>
                      <div class="o_row">
                          <field name="parent_id"
                              widget="res_partner_many2one"
                              placeholder="Company Name..."
                              domain="[('is_company', '=', True)]" context="{'default_is_company': True, 'show_vat': True, 'default_user_id': user_id}"
                              invisible="1"/>
                              <field name="company_name" invisible="not company_name or company_name == '' or is_company"/>
                              <button name="create_company" icon="fa-plus-square" string="Create company"
                                  type="object" class="oe_edit_only btn-link"
                                  invisible="is_company or company_name == '' or not company_name"/>
                      </div>
                  </div>

                  <group>
                      <field name="patient_backend_id" groups="p7_patient_management.group_user_admin"/>
                      <group>
                          <field id="individual" string="First Name" options="{'line_breaks': False}" widget="text" 
                                class="text-break" name="name" default_focus="1" 
                                placeholder="e.g. Brandom Freeman" invisible="is_company"
                                required="type == 'contact'"/>
                          <field id="individual" options="{'line_breaks': False}" widget="text" 
                                class="text-break" name="last_name" 
                                invisible="is_company" required="type == 'contact'"/>
                          <field name="vat" invisible="1" placeholder="e.g. BE0477472701" readonly="parent_id"/>
                          <!-- <field name="mobile" widget="phone" invisible="1"/> -->
                          <label for="mob" />
                          <div class="d-flex">
                              <field name="phone_code" placeholder="+XX" required="1" style="width:15%;" options="{'no_create': True, 'no_open': True}" nolabel="1"/>
                              <field name="mob" required="1" nolabel="1" style="margin-left:17px;" placeholder="Enter phone number"/>
                          </div>
                          <field name="user_ids" invisible="1" />
                          <field name="email" widget="email" context="{'gravatar_image': True}" required="0"/>
                          <field name="dob" required="1"/>
                          <field name="nric_number" required="user_type == 'patient'"/>
                          <field name="gender" required="1" />
                          <span class="o_form_label o_td_label" >
                              <field name="type" invisible="1" readonly="user_ids" required="not is_company" class="fw-bold"/>
                              <b>Address</b>
                          </span>
                          <div class="o_address_format">
                              <field name="street" placeholder="Street..." class="o_address_street"
                                  readonly="type == 'contact' and parent_id"/>
                              <field name="street2" placeholder="Street 2..." class="o_address_street"
                                  readonly="type == 'contact' and parent_id"/>
                              <field name="city" placeholder="City" class="o_address_city"
                                  readonly="type == 'contact' and parent_id"/>
                              <field name="state_id" class="o_address_state" placeholder="State" options="{'no_open': True, 'no_quick_create': True}"
                                  readonly="type == 'contact' and parent_id" context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                              <field name="zip" placeholder="ZIP" class="o_address_zip"
                                  readonly="type == 'contact' and parent_id"/>
                              <div name="partner_address_country" class="d-flex justify-content-between">
                                  <field name="country_id" placeholder="Country" class="o_address_country" options='{"no_open": True, "no_create": True}'
                                      readonly="type == 'contact' and parent_id"/>
                              </div>
                          </div>
                          <field name="phone" widget="phone"/>
                      </group>
                      <group>
                          <field name="function" placeholder="e.g. Sales Director"
                              invisible="1"/>
                          <field name="bio" placeholder="Add a note about yourself..." invisible="user_type != 'doctor'"/>
                          <field name="interest" invisible="user_type != 'doctor'"/>
                          <field name="skill" invisible="user_type != 'doctor'"/>
                          <field name="oms_number" invisible="user_type != 'doctor'"/>
                          <field name="language"/>
                          <field name="website" string="Website" widget="url" invisible="1" placeholder="e.g. https://www.odoo.com"/>
                          <field name="title" options='{"no_open": True}' placeholder="e.g. Mister"
                              invisible="1"/>
                          <field name="active_lang_count" invisible="1"/>
                          <field name="lang" invisible="active_lang_count &lt;= 1"/>
                          <field name="user_type" invisible="1"/>
                          <field name="category_id" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}"
                                  placeholder='e.g. "B2B", "VIP", "Consulting", ...'/>
                          <field name="doctor_id" invisible="user_type != 'patient'"/>
                          <field name="tz" />
                          <field name="mobile" string="Note"/>
                      </group>
                  </group>

                  <notebook colspan="4">
                      <page string="Doctors" name="doctor_details" autofocus="autofocus" invisible="user_type != 'admin'">
                          <field name="doctor_ids">
                              <tree string="Doctor List" editable="bottom" create="0" delete="0">
                                  <field name="name" string="Patient ID"/>
                                  <field name="name"/>
                                  <field name="last_name"/>
                                  <field name="mob"/>
                              </tree>
                          </field>
                      </page>
                      <page string="Patients" name="patient_details" invisible="user_type not in ('admin','doctor')">
                          <field name="patient_ids" readonly="1">
                              <tree string="Patient List" editable="bottom" create="0" delete="0">
                                  <field name="name" string="Patient ID"/>
                                  <field name="name"/>
                                  <field name="last_name"/>
                                  <field name="mob"/>
                              </tree>
                          </field>
                      </page>
                      <page string="Operations" name="operation_details" invisible="user_type == 'patient'">
                            <field name="operation_ids" readonly="1">
                                <tree string="Operation List" editable="bottom" create="0" delete="0">
                                    <field name="name" string="Patient Case ID"/>
                                    <field name="patient_first_name"/>
                                    <field name="patient_last_name"/>
                                    <field name="op_process"/>
                                    <field name="op_date"/>
                                    <field name="op_location_id"/>
                                    <field name="medic_state" widget="badge" decoration-info="medic_state == 'draft'" decoration-danger="medic_state in ('confirm','in_progress')" decoration-warning="medic_state == 'submit'" decoration-success="medic_state == 'review'"/>
                                </tree>
                            </field>
                      </page>
                      <page string="Medical History Submissions" name="medical_history_details" invisible="user_type == 'patient'">
                            <field name="operation_ids" readonly="1">
                                <tree string="Submission List" editable="bottom" create="0" delete="0">
                                    <field name="name" string="Patient Case ID"/>
                                    <field name="patient_first_name"/>
                                    <field name="patient_last_name"/>
                                    <field name="medic_survey_start_date"/>
                                    <field name="medic_survey_submit_date"/>
                                    <field name="medic_state" widget="badge" decoration-info="medic_state == 'draft'" decoration-danger="medic_state in ('confirm','in_progress')" decoration-warning="medic_state == 'submit'" decoration-success="medic_state == 'review'"/>
                                    <button name="action_answer_form" invisible="medic_state != 'submit'" string="" class="fa fa-file-text-o" type="object" title="Open answer form"/>
                                </tree>
                            </field>
                      </page>
                      <page string="Operations" name="operation_details" invisible="user_type != 'patient'">
                            <field name="patient_operation_ids" readonly="1">
                                <tree string="Operation List" editable="bottom" create="0" delete="0">
                                    <field name="name" string="Patient Case ID"/>
                                    <field name="op_process"/>
                                    <field name="op_date"/>
                                    <field name="op_location_id"/>
                                    <field name="medic_state" widget="badge" decoration-info="medic_state == 'draft'" decoration-danger="medic_state in ('confirm','in_progress')" decoration-warning="medic_state == 'submit'" decoration-success="medic_state == 'review'"/>
                                </tree>
                            </field>
                      </page>
                      <page string="Medical History Submissions" name="medical_history_details" invisible="user_type != 'patient'">
                            <field name="patient_operation_ids" readonly="1">
                                <tree string="Submission List" editable="bottom" create="0" delete="0">
                                    <field name="medic_survey_start_date"/>
                                    <field name="medic_survey_submit_date"/>
                                    <field name="medic_state" widget="badge" decoration-info="medic_state == 'draft'" decoration-danger="medic_state in ('confirm','in_progress')" decoration-warning="medic_state == 'submit'" decoration-success="medic_state == 'review'"/>
                                    <button name="action_answer_form" invisible="medic_state != 'submit'" string="" class="fa fa-file-text-o" type="object" title="Open answer form"/>
                                </tree>
                            </field>
                      </page>
                      <page string="Contacts &amp; Addresses" name="contact_addresses" invisible="1" autofocus="autofocus">
                          <field name="child_ids" mode="kanban" context="{'default_parent_id': id, 'default_street': street, 'default_street2': street2, 'default_city': city, 'default_state_id': state_id, 'default_zip': zip, 'default_country_id': country_id, 'default_lang': lang, 'default_user_id': user_id, 'default_type': 'other'}">
                              <kanban>
                                  <field name="id"/>
                                  <field name="color"/>
                                  <field name="name"/>
                                  <field name="title"/>
                                  <field name="type"/>
                                  <field name="email"/>
                                  <field name="parent_id"/>
                                  <field name="is_company"/>
                                  <field name="function"/>
                                  <field name="phone"/>
                                  <field name="street"/>
                                  <field name="street2"/>
                                  <field name="zip"/>
                                  <field name="city"/>
                                  <field name="country_id"/>
                                  <field name="mobile"/>
                                  <field name="state_id"/>
                                  <field name="image_128"/>
                                  <field name="avatar_128"/>
                                  <field name="lang"/>
                                  
                                  <field name="comment"/>
                                  <field name="display_name"/>
                                  <templates>
                                      <t t-name="kanban-box">
                                          <t t-set="color" t-value="kanban_color(record.color.raw_value)"/>
                                          <div t-att-class="color + (record.title.raw_value == 1 ? ' oe_kanban_color_alert' : '') + ' oe_kanban_global_click'">
                                              <div class="o_kanban_image">
                                                  <img alt="Contact image" t-att-src="kanban_image('res.partner', 'avatar_128', record.id.raw_value)"/>
                                              </div>
                                              <div class="oe_kanban_details">
                                                  <field name="name"/>
                                                  <div t-if="record.function.raw_value"><field name="function"/></div>
                                                  <div t-if="record.email.raw_value"><field name="email" widget="email"/></div>
                                                  <div t-if="record.type.raw_value != 'contact'">
                                                      <div>
                                                          <field name="zip"/><t t-if="record.city"> </t>
                                                          <field name="city"/>
                                                      </div>
                                                      <field t-if="record.state_id.raw_value" name="state_id"/><t t-if="record.country_id"> </t>
                                                      <field name="country_id"/>
                                                  </div>
                                                  <div t-if="record.phone.raw_value">Phone: <t t-esc="record.phone.value"/></div>
                                                  <div t-if="record.mobile.raw_value">Mobile: <t t-esc="record.mobile.value"/></div>
                                              </div>
                                          </div>
                                      </t>
                                  </templates>
                              </kanban>
                              <form string="Contact / Address">
                                  <sheet>
                                      <field name="type" required="1" widget="radio" options="{'horizontal': true}"/>
                                      <field name="parent_id" invisible="1"/>
                                      <div class="text-muted oe_edit_only">
                                          <p class="mb-0" invisible="type != 'contact'">
                                              <span>Use this to organize the contact details of employees of a given company (e.g. CEO, CFO, ...).</span>
                                          </p>
                                          <p class="mb-0" invisible="type != 'invoice'">
                                              <span>Preferred address for all invoices. Selected by default when you invoice an order that belongs to this company.</span>
                                          </p>
                                          <p class="mb-0" invisible="type != 'delivery'">
                                              <span>Preferred address for all deliveries. Selected by default when you deliver an order that belongs to this company.</span>
                                          </p>
                                          <p class="mb-0" invisible="type != 'other'">
                                              <span>Other address for the company (e.g. subsidiary, ...)</span>
                                          </p>
                                      </div>
                                      <hr/>
                                      <group>
                                          <group>
                                              <field name="name" string="Contact Name" required="type == 'contact'"/>
                                              <field name="title" options="{'no_open': True}" placeholder="e.g. Mr."
                                                  invisible="type != 'contact'"/>
                                              <field name="function" placeholder="e.g. Sales Director"
                                                  invisible="type != 'contact'"/>
                                              <label for="street" string="Address" invisible="type == 'contact'"/>
                                              <div invisible="type == 'contact'">
                                                  <div class="o_address_format" name="div_address">
                                                      <field name="street" placeholder="Street..." class="o_address_street"/>
                                                      <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                                                      <field name="city" placeholder="City" class="o_address_city"/>
                                                      <field name="state_id" class="o_address_state" placeholder="State" options="{'no_open': True, 'no_quick_create': True}" context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                                                      <field name="zip" placeholder="ZIP" class="o_address_zip"/>
                                                      <field name="country_id" placeholder="Country" class="o_address_country" options='{"no_open": True, "no_create": True}'/>
                                                  </div>
                                              </div>
                                          </group>
                                          <group>
                                              <field name="email" widget="email"/>
                                              <field name="phone" widget="phone"/>
                                              <field name="mobile" widget="phone"/>
                                              <field name="company_id" invisible="1"/>
                                          </group>
                                      </group>
                                      <group>
                                          <field name="comment" placeholder="Internal notes..." nolabel="1" colspan="2"/>
                                      </group>
                                      <field name="lang" invisible="True"/>
                                      <field name="user_id" invisible="True"/>
                                  </sheet>
                              </form>
                          </field>
                      </page>
                      <page name='sales_purchases' string="Sales &amp; Purchase" invisible="1">
                          <group name="container_row_2">
                              <group string="Sales" name="sale" priority="1">
                                  <field name="user_id" widget="many2one_avatar_user" domain="[('share', '=', False)]"/>
                              </group>
                              <group string="Purchase" name="purchase" priority="2">
                              </group>
                              <group name="misc" string="Misc">
                                  <field name="company_registry" invisible="parent_id"/>
                                  <field name="ref" string="Reference"/>
                                  <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}" readonly="parent_id" force_save="1"/>
                                  <field name="industry_id" invisible="not is_company" options="{'no_create': True}"/>
                              </group>
                          </group>
                      </page>
                      <page name='internal_notes' string="Internal Notes">
                          <field name="comment" placeholder="Internal notes..."/>
                      </page>
                  </notebook>
              </sheet>
              </form>
          </field>
      </record>

      <record id="res_partner_view_inherited" model="ir.ui.view">
        <field name="name">res.partner.form.inherit.view</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='mobile']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
      </record>

      <record id="res_users_view_inherited" model="ir.ui.view">
        <field name="name">res.users.form.inherit.view</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='tz']" position="after">
                <field name="is_specific_login" />
                <field name="is_tech_support" />
            </xpath>
        </field>
      </record>

      <record id="res_partner_tree_view_inherited" model="ir.ui.view">
        <field name="name">res.partner.tree.inherit.view</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//tree" position="inside">
                <field name="patient_backend_id" groups="p7_patient_management.group_user_admin"/>
            </xpath>
            <xpath expr="//field[@name='phone']" position="replace">
                <field name="phone" class="o_force_ltr" optional="hide"/>
                <field name="mob" class="o_force_ltr" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='user_id']" position="replace">
                <field name="user_id" optional="hide" widget="many2one_avatar_user" domain="[('share', '=', False)]"/>
            </xpath>
            <xpath expr="//field[@name='display_name']" position="replace">
                <field name="name" string="Name"/>
            </xpath>
        </field>
      </record>

      <record id="res_partner_view_search_cutm" model="ir.ui.view">
            <field name="name">res.partner.view.search.inherit.cutm</field>
            <field name="model">res.partner</field>
            <field name="inherit_id" ref="sms.res_partner_view_search"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='phone_mobile_search']" position="replace">
                    <field name="mob" string="Mobile" filter_domain="[('mob', 'ilike', self)]"/>
                </xpath>
            </field>
        </record>

        <record id="sms_sms_form_cutm" model="ir.ui.view">
            <field name="name">sms.sms.view.form.inherit.cutm</field>
            <field name="model">sms.sms</field>
            <field name="inherit_id" ref="sms.sms_tsms_view_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='number']" position="after">
                    <field name="create_date" readonly="1"/>
                    <field name="write_date" readonly="1"/>
                </xpath>
            </field>
        </record>

        <record id="sms_sms_form_cutm_tree" model="ir.ui.view">
            <field name="name">sms.sms.view.tree.inherit.cutm</field>
            <field name="model">sms.sms</field>
            <field name="inherit_id" ref="sms.sms_sms_view_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='state']" position="after">
                    <field name="write_date" readonly="1"/>
                </xpath>
            </field>
        </record>

  </data>
</odoo>
